# Chat API Endpoints - 6/25/25

## Overview
Supabase-powered chat system with Groq AI integration. All endpoints use `/api/chat/` prefix.

## Core Endpoints

### 1. Create Session
```bash
POST /api/chat/sessions
Body: { "userId": "string", "title": "string" }
```
Creates new chat session with auto-generated UUID.

### 2. Add Message (Manual)
```bash
POST /api/chat/sessions/:sessionId/messages
Body: { "role": "user|assistant|system", "content": "string" }
```
Adds single message to session without AI.

### 3. Chat with AI (Full Flow)
```bash
POST /api/chat/sessions/:sessionId/chat
Body: { "content": "string" }
```
**Main endpoint:** Adds user message → sends to Groq → stores AI response.

### 4. Get Session
```bash
GET /api/chat/sessions/:userId/:sessionId
```
Returns session with all messages.

### 5. Get User Sessions
```bash
GET /api/chat/sessions/:userId
```
Returns all active sessions for user (sorted by recent).

### 6. Get Context
```bash
GET /api/chat/sessions/:sessionId/context?maxMessages=10
```
Returns last N messages for AI context.

## Data Flow
1. **User Message** → Supabase
2. **Context Retrieval** → Format for Groq
3. **AI Response** → Store in Supabase
4. **Return** → Both messages to client

## Database
- **Table:** `chat_sessions`
- **Messages:** JSONB array with `{id, role, content, timestamp}`
- **Auto-generated:** Session UUIDs, message IDs, timestamps

## Key Features
- ✅ Persistent storage (Supabase)
- ✅ Conversation context
- ✅ Groq AI integration
- ✅ User isolation
- ✅ Message history
